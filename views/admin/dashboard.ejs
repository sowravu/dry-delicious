    <%- include("../layouts/admin/header.ejs")  %>
    
    <%- include("../layouts/admin/navbar.ejs")  %>
    <main class="main-wrap">
        <!--  -->
        <%- include("../layouts/admin/topnav.ejs")  %>


        <style>
            .dashboard-section {
              margin: 2rem 0;
              padding: 0 1rem;
            }
          
            .section-heading {
              color: #333;
              font-size: 2rem;
              font-weight: bold;
              margin-bottom: 1.5rem;
              padding-bottom: 0.5rem;
              border-bottom: 2px solid #3b82f6;
            }
          
            .data-table {
              width: 100%;
              border-collapse: collapse;
              background-color: #fff;
              box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
              margin-bottom: 2rem;
            }
          
            .data-table th {
              background-color: #f8fafc;
              color: #1f2937;
              font-weight: 600;
              padding: 1rem;
              text-align: left;
              border-bottom: 2px solid #e2e8f0;
            }
          
            .data-table td {
              padding: 1rem;
              border-bottom: 1px solid #e2e8f0;
              color: #4b5563;
            }
          
            .data-table tr:hover {
              background-color: #f8fafc;
            }
          
            .data-table tr:last-child td {
              border-bottom: none;
            }
          </style>
          
          
       
        <section class="content-main">
            <div class="content-header">
                <div>
                    <h2 class="content-title card-title">Dashboard </h2>
                    <p>Whole data about your business here</p>
                </div>
                <div>
                    <a href="#" class="btn btn-primary"><i class="text-muted material-icons md-post_add"></i>Create report</a>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-3">
                    <div class="card card-body mb-4">
                        <article class="icontext">
                            <span class="icon icon-sm rounded-circle bg-primary-light"><i class="text-primary material-icons md-monetization_on"></i></span>
                            <div class="text">
                                <h6 class="mb-1 card-title">Total sales</h6>
                                <span>â‚¹<%= grandTotal %></span>
                                <span class="text-sm">
                                    Shipping fees are not included
                                </span>
                            </div>
                        </article>
                    </div>
                </div>
                <div class="col-lg-3">
                    <div class="card card-body mb-4">
                        <article class="icontext">
                            <span class="icon icon-sm rounded-circle bg-success-light"><i class="text-success material-icons md-local_shipping"></i></span>
                            <div class="text">
                                <h6 class="mb-1 card-title">Orders</h6> <span><%= totalOrders %></span>
                                <span class="text-sm">
                                    Excluding orders in transit
                                </span>
                            </div>
                        </article>
                    </div>
                </div>
                <div class="col-lg-3">
                    <div class="card card-body mb-4">
                        <article class="icontext">
                            <span class="icon icon-sm rounded-circle bg-warning-light"><i class="text-warning material-icons md-qr_code"></i></span>
                            <div class="text">
                                <h6 class="mb-1 card-title">Products</h6> <span><%= productCount %></span>
                                <span class="text-sm">
                                    In 4 Categories
                                </span>
                            </div>
                        </article>
                    </div>
                </div>
                <!-- <div class="col-lg-3">
                    <div class="card card-body mb-4">
                        <article class="icontext">
                            <span class="icon icon-sm rounded-circle bg-info-light"><i class="text-info material-icons md-shopping_basket"></i></span>
                            <div class="text">
                                <h6 class="mb-1 card-title">Monthly Earning</h6> <span></span>
                                <span class="text-sm">
                                    Based in your local time.
                                </span>
                            </div>
                        </article>
                    </div> -->
                </div>
            </div>
            <div class="row">
                <div class="col-xl-8 col-lg-12">
                    <div class="card mb-4">
                        <article class="card-body">
                            <h5 class="card-title">Sale statistics</h5>
                            <canvas id="myChart" height="120px"></canvas>
                        </article>
                    </div>
                    <div class="row">
                        <div class="col-lg-5">
                            <div class="card mb-4">
                                <article class="card-body">
                                    <h5 class="card-title">New Members</h5>
                                    <div class="new-member-list">
                                        <div class="d-flex align-items-center justify-content-between mb-4">
                                            <div class="d-flex align-items-center">
                                                <img src="assets/imgs/people/avatar4.jpg" alt="" class="avatar">
                                                <div>
                                                    <h6>Patric Adams</h6>
                                                    <p class="text-muted font-xs">
                                                        Sanfrancisco
                                                    </p>
                                                </div>
                                            </div>
                                            <a href="#" class="btn btn-xs"><i class="material-icons md-add"></i> Add</a>
                                        </div>
                                        <div class="d-flex align-items-center justify-content-between mb-4">
                                            <div class="d-flex align-items-center">
                                                <img src="assets/imgs/people/avatar2.jpg" alt="" class="avatar">
                                                <div>
                                                    <h6>Dilan Specter</h6>
                                                    <p class="text-muted font-xs">
                                                        Sanfrancisco
                                                    </p>
                                                </div>
                                            </div>
                                            <a href="#" class="btn btn-xs"><i class="material-icons md-add"></i> Add</a>
                                        </div>
                                        <div class="d-flex align-items-center justify-content-between mb-4">
                                            <div class="d-flex align-items-center">
                                                <img src="assets/imgs/people/avatar3.jpg" alt="" class="avatar">
                                                <div>
                                                    <h6>Tomas Baker</h6>
                                                    <p class="text-muted font-xs">
                                                        Sanfrancisco
                                                    </p>
                                                </div>
                                            </div>
                                            <a href="#" class="btn btn-xs"><i class="material-icons md-add"></i> Add</a>
                                        </div>
                                    </div>
                                </article>
                            </div>
                        </div>
                        <div class="col-lg-7">
                            <div class="card mb-4">
                                <article class="card-body">
                                    <h5 class="card-title">Recent activities</h5>
                                    <ul class="verti-timeline list-unstyled font-sm">
                                        <li class="event-list">
                                            <div class="event-timeline-dot">
                                                <i class="material-icons md-play_circle_outline font-xxl"></i>
                                            </div>
                                            <div class="media">
                                                <div class="me-3">
                                                    <h6><span>Today</span> <i class="material-icons md-trending_flat text-brand ml-15 d-inline-block"></i></h6>
                                                </div>
                                                <div class="media-body">
                                                    <div>
                                                        Lorem ipsum dolor sit amet consectetur
                                                    </div>
                                                </div>
                                            </div>
                                        </li>
                                        <li class="event-list active">
                                            <div class="event-timeline-dot">
                                                <i class="material-icons md-play_circle_outline font-xxl animation-fade-right"></i>
                                            </div>
                                            <div class="media">
                                                <div class="me-3">
                                                    <h6><span>17 May</span> <i class="material-icons md-trending_flat text-brand ml-15 d-inline-block"></i></h6>
                                                </div>
                                                <div class="media-body">
                                                    <div>
                                                        Debitis nesciunt voluptatum dicta reprehenderit
                                                    </div>
                                                </div>
                                            </div>
                                        </li>
                                        <li class="event-list">
                                            <div class="event-timeline-dot">
                                                <i class="material-icons md-play_circle_outline font-xxl"></i>
                                            </div>
                                            <div class="media">
                                                <div class="me-3">
                                                    <h6><span>13 May</span> <i class="material-icons md-trending_flat text-brand ml-15 d-inline-block"></i></h6>
                                                </div>
                                                <div class="media-body">
                                                    <div>
                                                        Accusamus voluptatibus voluptas.
                                                    </div>
                                                </div>
                                            </div>
                                        </li>
                                        <li class="event-list">
                                            <div class="event-timeline-dot">
                                                <i class="material-icons md-play_circle_outline font-xxl"></i>
                                            </div>
                                            <div class="media">
                                                <div class="me-3">
                                                    <h6><span>05 April</span> <i class="material-icons md-trending_flat text-brand ml-15 d-inline-block"></i></h6>
                                                </div>
                                                <div class="media-body">
                                                    <div>
                                                        At vero eos et accusamus et iusto odio dignissi
                                                    </div>
                                                </div>
                                            </div>
                                        </li>
                                        <li class="event-list">
                                            <div class="event-timeline-dot">
                                                <i class="material-icons md-play_circle_outline font-xxl"></i>
                                            </div>
                                            <div class="media">
                                                <div class="me-3">
                                                    <h6><span>26 Mar</span> <i class="material-icons md-trending_flat text-brand ml-15 d-inline-block"></i></h6>
                                                </div>
                                                <div class="media-body">
                                                    <div>
                                                        Responded to need â€œVolunteer Activities
                                                    </div>
                                                </div>
                                            </div>
                                        </li>
                                    </ul>
                                </article>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-xl-4 col-lg-12">
                    <div class="card mb-4">
                        <article class="card-body">
                            <h5 class="card-title">Revenue Base on Area</h5>
                            <canvas id="myChart2" height="217"></canvas>
                        </article>
                    </div>
                    <div class="card mb-4">
                        <article class="card-body">
                            <h5 class="card-title">Marketing Chanel</h5>
                            <span class="text-muted font-xs">Facebook</span>
                            <div class="progress mb-3">
                                <div class="progress-bar" role="progressbar" style="width: 15%">15%</div>
                            </div>
                            <span class="text-muted font-xs">Instagram</span>
                            <div class="progress mb-3">
                                <div class="progress-bar" role="progressbar" style="width: 65%">65% </div>
                            </div>
                            <span class="text-muted font-xs">Google</span>
                            <div class="progress mb-3">
                                <div class="progress-bar" role="progressbar" style="width: 51%"> 51% </div>
                            </div>
                            <span class="text-muted font-xs">Twitter</span>
                            <div class="progress mb-3">
                                <div class="progress-bar" role="progressbar" style="width: 80%"> 80%</div>
                            </div>
                            <span class="text-muted font-xs">Other</span>
                            <div class="progress mb-3">
                                <div class="progress-bar" role="progressbar" style="width: 80%"> 80%</div>
                            </div>
                        </article>
                    </div>
                </div>
            </div>

            <div class="dashboard-section">
                <h2 class="section-heading">Top-Selling Products</h2>
                <table class="data-table">
                  <thead>
                    <tr>
                      <th>Product Name</th>
                      <th>Sales Count</th>
                      <th>Category</th>
                      <th>Brand</th>
                    </tr>
                  </thead>
                  <tbody>
                    <% topProducts.forEach(product => { %>
                      <tr>
                        <td><%= product.name %></td>
                        <td><%= product.count %></td>
                        <td><%= product.categoryName %></td>
                        <td><%= product.brandName %></td>
                      </tr>
                    <% }); %>
                  </tbody>
                </table>
              </div>
              
              <div class="dashboard-section">
                <h2 class="section-heading">Top-Selling Categories</h2>
                <table class="data-table">
                  <thead>
                    <tr>
                      <th>Category Name</th>
                      <th>Sales Count</th>
                    </tr>
                  </thead>
                  <tbody>
                    <% categorySales.forEach(category => { %>
                      <tr>
                        <td><%= category.categoryName %></td>
                        <td><%= category.count %></td>
                      </tr>
                    <% }); %>
                  </tbody>
                </table>
              </div>
              
              <div class="dashboard-section">
                <h2 class="section-heading">Top-Selling Brands</h2>
                <table class="data-table">
                  <thead>
                    <tr>
                      <th>Brand Name</th>
                      <th>Sales Count</th>
                    </tr>
                  </thead>
                  <tbody>
                    <% brandSales.forEach(brand => { %>
                      <tr>
                        <td><%= brand.brandName %></td>
                        <td><%= brand.count %></td>
                      </tr>
                    <% }); %>
                  </tbody>
                </table>
              </div>



            <div class="card mb-4">
                <header class="card-header">
                  <h2 class="card-title">Sales Report</h2>
                  <div class="row align-items-center justify-content-end">
                    <div class="col-md-2 col-6">
                      <div class="custom_select">
                        <form id="filterForm" action="/admin/dashboard" method="GET">
                            <select name="filter" id="filter-select" onchange="document.getElementById('filterForm').submit()">
                              <option value="All" <%= filter === "All" ? "selected" : "" %>>All</option>
                              <option value="Today" <%= filter === "Today" ? "selected" : "" %>>Today</option>
                              <option value="This Week" <%= filter === "This Week" ? "selected" : "" %>>This Week</option>
                              <option value="Last Month" <%= filter === "Last Month" ? "selected" : "" %>>Last Month</option>
                              <option value="Yearly" <%= filter === "Yearly" ? "selected" : "" %>>Yearly</option>
                            </select>
                          </form>
                      </div>
                    </div>
                  </div>
                </header>

                <div class="mb-3 text-end">
                    <a href="/admin/dashboard/pdf?filter=<%= filter %>" class="btn btn-primary">Download PDF</a>
                    <a href="/admin/dashboard/excel?filter=<%= filter %>" class="btn btn-success">Download Excel</a>
                  </div>
                

                <div class="card-body">
                  <div class="mb-3 text-end">
                    <h5>Grand Total: â‚¹<%= grandTotal || 0 %></h5>
                  </div>
                  <div class="table-responsive">
                    <table class="table align-middle table-nowrap mb-0">
                      <thead class="table-light">
                        <tr>
                          <th scope="col" class="text-center">
                            <div class="form-check align-middle">
                              <input class="form-check-input" type="checkbox" id="selectAll">
                              <label class="form-check-label" for="selectAll"></label>
                            </div>
                          </th>
                          <th class="align-middle" scope="col">Order ID</th>
                          <th class="align-middle" scope="col">Product Name</th>
                          <th class="align-middle" scope="col">Date</th>
                          <th class="align-middle" scope="col">Total</th>
                          <th class="align-middle" scope="col">Payment Status</th>
                          <th class="align-middle" scope="col">Payment Method</th>
                        </tr>
                      </thead>
                      <tbody>
                        <% if (orders && orders.length > 0) { %>
                          <% orders.forEach(order => { %>
                            <tr>
                              <td class="text-center">
                                <div class="form-check align-middle">
                                  <input class="form-check-input" type="checkbox" id="orderCheck<%= order._id %>">
                                  <label class="form-check-label" for="orderCheck<%= order._id %>"></label>
                                </div>
                              </td>
                              <td><a href="#" class="fw-bold"><%= order.orderId %></a></td>
                              <td>
                                <% order.items.forEach(item => { %>
                                  <div><%= item.name %> (<%= item.quantity %> x <%= item.size %>)</div>
                                <% }) %>
                              </td>
                              <td><%= new Date(order.createdAt).toLocaleDateString() %></td>
                              <td>â‚¹<%= order.total_price %></td>
                              <td>
                                <span class="badge badge-pill <%= order.payment_status === 'success' ? 'badge-soft-success' : 'badge-soft-danger' %>">
                                  <%= order.payment_status %>
                                </span>
                              </td>
                              <td>
                                <i class="material-icons md-payment font-xxl text-muted mr-5"></i>
                                <%= order.payment_method %>
                              </td>
                            </tr>
                          <% }) %>
                        <% } else { %>
                          <tr>
                            <td colspan="7" class="text-center">No orders found.</td>
                          </tr>
                        <% } %>
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
              
              
            <div class="pagination-area mt-30 mb-50">
                <nav aria-label="Page navigation example">
                    <ul class="pagination justify-content-start">
                        <li class="page-item active"><a class="page-link" href="#">01</a></li>
                        <li class="page-item"><a class="page-link" href="#">02</a></li>
                        <li class="page-item"><a class="page-link" href="#">03</a></li>
                        <li class="page-item"><a class="page-link dot" href="#">...</a></li>
                        <li class="page-item"><a class="page-link" href="#">16</a></li>
                        <li class="page-item"><a class="page-link" href="#"><i class="material-icons md-chevron_right"></i></a></li>
                    </ul>
                </nav>
            </div>
        </section> <!-- content-main end// -->
       
        <%- include("../layouts/admin/footer.ejs")  %>
